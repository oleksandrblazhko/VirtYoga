# Адаптація розділів вищої математики до теми IT-проєктів: Аналіз йога-поз за допомогою матриць

Цей документ досліджує застосування матричного числення для аналізу та опису людських суглобів у контексті IT-проєкту "Віртуальна Йога". Метою є демонстрація практичної цінності вищої математики, зокрема лінійної алгебри, для студентів, що працюють над IT-проєктами.

## 1. Опис функціональних вимог до IT-проєкту "Віртуальна Йога"

Згідно з наданим описом функціональних вимог, проєкт "Віртуальна Йога" використовує вебкамеру та бібліотеку MediaPipe для розпізнавання скелету людини, що включає 33 суглоби. Для кожного суглоба отримуються координати (x, y, z). Програма надає користувачеві зворотний зв'язок щодо правильності виконання йога-пози на основі попередньо визначених описів поз, які можуть включати координати або кути суглобів.

## 2. Короткий опис розділу вищої математики: Числові матриці

Матриця - це прямокутна таблиця чисел (або інших елементів), розташованих у рядках та стовпцях. Матриці є потужним інструментом для представлення та маніпулювання даними, системами рівнянь та трансформаціями у просторі. Розділ лінійної алгебри, присвячений матрицям, включає їх означення, різновиди (рядкові, стовпцеві, квадратні, трикутні, діагональні, одиничні, блокові), арифметичні операції (додавання, множення на скаляр, множення матриць) та елементарні перетворення. Також важливими є поняття визначника матриці та його властивості, а також методи розв'язання систем лінійних алгебраїчних рівнянь, наприклад, за правилом Крамера.

## 3. Варіанти опису суглобів людини з використанням матриць

Розглянемо кілька варіантів матричного представлення даних про суглоби, отриманих від MediaPipe:

### Варіант 1: Матриця координат суглобів (Joint Coordinate Matrix)

**Опис:**
Це найпростіший та найпряміший спосіб представлення даних. Для кожного з 33 суглобів ми маємо три координати (x, y, z). Ці дані можна організувати у матрицю розміром `33x3`, де кожен рядок відповідає одному суглобу, а стовпці – його координатам `(x, y, z)`.

**Структура матриці:**
```
J = 
[ x_nose   y_nose   z_nose   ]
[ x_leye_i y_leye_i z_leye_i ]
[ ...      ...      ...      ]
[ x_rfoot_i y_rfoot_i z_rfoot_i ]
```
Де `J` – матриця суглобів, `x_i`, `y_i`, `z_i` – координати i-го суглоба.

### Варіант 2: Матриця векторів сегментів тіла (Body Segment Vector Matrix)

**Опис:**
Цей підхід фокусується на взаємному розташуванні суглобів, формуючи вектори, що з'єднують пов'язані суглоби (наприклад, плече-лікоть, лікоть-зап'ястя). Кожен вектор можна представити його компонентами (dx, dy, dz) або довжиною та кутами орієнтації. Для простоти, ми можемо створити матрицю, де кожен рядок представляє вектор між двома конкретними суглобами (наприклад, батьківським і дочірнім у кінематичному ланцюзі), а стовпці – компоненти цього вектора.

**Структура матриці:**
Спочатку потрібно визначити значущі сегменти тіла. Наприклад:
-   Вектор "Праве плече - Правий лікоть" (V_R_Shoulder_Elbow)
-   Вектор "Правий лікоть - Праве зап'ястя" (V_R_Elbow_Wrist)
-   ... і так далі для всіх ключових сегментів.

```
V = 
[ dx_R_SE dy_R_SE dz_R_SE ]
[ dx_R_EW dy_R_EW dz_R_EW ]
[ ...     ...     ...     ]
```
Де `V` – матриця векторів сегментів, `dx_ij`, `dy_ij`, `dz_ij` – компоненти вектора від суглоба i до суглоба j. Розмір цієї матриці залежатиме від кількості визначених сегментів.

### Варіант 3: Матриця трансформації (Transformation Matrix)

**Опис:**
Цей варіант є більш складним, але набагато потужнішим для представлення орієнтації та позиції суглобів відносно один одного, особливо для розрахунку кутів. Використовуються 4x4 однорідні матриці трансформації, які об'єднують обертання та переміщення. Кожен суглоб або сегмент тіла може мати свою власну систему координат, а його положення та орієнтація відносно батьківського суглоба або глобальної системи координат описується такою матрицею.

Наприклад, для суглоба `S_child` відносно `S_parent`:
`T_parent_to_child = [ R_xx R_xy R_xz T_x; R_yx R_yy R_yz T_y; R_zx R_zy R_zz T_z; 0 0 0 1 ]`
Де `R` – матриця обертання `3x3`, а `T` – вектор переміщення `3x1`.

**Структура системи матриць:**
Замість однієї великої матриці, ми матимемо ієрархію матриць трансформації. Наприклад, якщо ми беремо стегна як кореневий суглоб:
-   `T_global_to_left_hip` (переміщення лівого стегна від глобального початку координат)
-   `T_left_hip_to_left_knee` (обертання та переміщення лівого коліна відносно лівого стегна)
-   `T_left_knee_to_left_ankle` (обертання та переміщення лівої щиколотки відносно лівого коліна)
... і так далі для всього скелета.
Глобальна позиція будь-якого суглоба обчислюється шляхом послідовного множення матриць:
`T_global_ankle = T_global_to_left_hip * T_left_hip_to_left_knee * T_left_knee_to_left_ankle`

## 4. Приклади опису матриці для Йога-вправ

Розглянемо дві йога-вправи: Поза Воїна I (Virabhadrasana I) та Поза Воїна II (Virabhadrasana II).

### 4.1. Поза Воїна I (Virabhadrasana I)

**Текстовий опис вправи:**
Поза Воїна I – це симетрична поза стоячи, яка зміцнює ноги, розкриває стегна і грудну клітку, а також подовжує хребет.
-   Права нога (передня) зігнута в коліні під кутом приблизно 90 градусів, стегно паралельно підлозі, коліно знаходиться прямо над щиколоткою.
-   Ліва нога (задня) пряма і сильно витягнута назад, стопа розвернута під кутом 45-60 градусів назовні.
-   Стегна дивляться вперед, вирівняні.
-   Корпус спрямований вперед, витягнутий вгору.
-   Руки підняті вгору, прямі, долоні дивляться одна на одну або з'єднані.
-   Плечі опущені від вух.
-   Погляд спрямований вперед.

#### 4.1.1. Матричний опис суглобів для Пози Воїна I

**Варіант 1: Матриця координат суглобів**

Для цієї пози ми б очікували побачити такі приблизні координати суглобів (значення є ілюстративними, припускаючи, що людина стоїть по центру камери, а вісь Y йде вгору, Z – в глибину, X – вправо):

```
J_Warrior1 = 
[ x_nose   y_nose   z_nose   ]
[ x_leye_i y_leye_i z_leye_i ]
[ ...      ...      ...      ]
[ x_lshoulder y_lshoulder z_lshoulder ] (приблизно симетрично до правого, але вище)
[ x_rshoulder y_rshoulder z_rshoulder ] (приблизно симетрично до лівого, але вище)
[ x_lhip    y_lhip    z_lhip    ] (ліве стегно трохи ззаду і нижче)
[ x_rhip    y_rhip    z_rhip    ] (праве стегно спереду і нижче)
[ x_lknee   y_lknee   z_lknee   ] (ліве коліно пряме, ззаду)
[ x_rknee   y_rknee   z_rknee   ] (праве коліно зігнуте 90 градусів)
[ x_lankle  y_lankle  z_lankle  ] (ліва щиколотка ззаду)
[ x_rankle  y_rankle  z_rankle  ] (права щиколотка спереду)
[ ...      ...      ...      ]
```
Приклад реальних значень кутів (для правильної пози):
-   **Праве коліно:** Кут згинання близько 90 градусів.
-   **Ліве коліно:** Кут згинання близько 180 градусів (пряма нога).
-   **Ліва стопа:** Обертання назовні приблизно 45-60 градусів відносно осі тіла.
-   **Стегна:** Обертання стегнового поясу мінімальне, орієнтовані вперед.
-   **Руки:** Кут між верхньою частиною руки та корпусом близько 180 градусів (руки витягнуті вгору).

**Варіант 2: Матриця векторів сегментів тіла**

Тут ми б розглядали вектори, що сполучають ключові суглоби, і їхні компоненти. Наприклад, для правої ноги:
-   `V_R_Hip_Knee = [dx, dy, dz]` (вектор від правого стегна до правого коліна)
-   `V_R_Knee_Ankle = [dx, dy, dz]` (вектор від правого коліна до правої щиколотки)

Для Пози Воїна I, `V_R_Hip_Knee` та `V_R_Knee_Ankle` будуть майже перпендикулярні у площині XY (якщо дивитися збоку), а `V_L_Hip_Knee` та `V_L_Knee_Ankle` будуть майже колінеарні.

```
V_Warrior1 = 
[ dx_L_H_K dy_L_H_K dz_L_H_K ] (Ліве стегно-коліно, пряма нога)
[ dx_L_K_A dy_L_K_A dz_L_K_A ] (Ліве коліно-щиколотка, пряма нога)
[ dx_R_H_K dy_R_H_K dz_R_H_K ] (Праве стегно-коліно, зігнута нога)
[ dx_R_K_A dy_R_K_A dz_R_K_A ] (Праве коліно-щиколотка, зігнута нога)
[ dx_Torso_Head dy_Torso_Head dz_Torso_Head ] (наприклад, від стегон до шиї)
[ ...                             ...       ...     ]
```

**Варіант 3: Матриця трансформації**

Цей підхід дозволяє моделювати кінематичний ланцюг тіла. Для кожної пари суглобів, наприклад, від `стегна` до `коліна`, ми можемо визначити матрицю трансформації `T`.
Наприклад, для Пози Воїна I:

-   `T_Global_Pelvis`: Трансформація тазу від глобальної системи координат.
-   `T_Pelvis_R_Hip`: Трансформація правого стегна відносно тазу.
-   `T_R_Hip_R_Knee`: Трансформація правого коліна відносно правого стегна. Для зігнутого коліна, матриця обертання `R` тут буде відображати обертання навколо осі X (або іншої, залежно від конвенції), а вектор `T` – довжину стегна.
-   `T_R_Knee_R_Ankle`: Трансформація правої щиколотки відносно правого коліна. Для прямої гомілки, `R` буде одиничною матрицею обертання, `T` – довжина гомілки.
-   Аналогічно для лівої ноги, рук та верхньої частини тіла.

#### 4.1.2. Приклад матриці з реальними значеннями для Пози Воїна I (для Варіанта 1 - Матриця координат)

Припустимо, ми виміряли координати для ідеальної Пози Воїна I (передня права нога):

**Приклад (спрощені та ілюстративні значення, в одиницях MediaPipe):**
*   **Правий кульшовий суглоб (24):** [0.1, 0.5, 0.0]
*   **Праве коліно (26):** [0.1, 0.2, -0.1]
*   **Права щиколотка (28):** [0.1, 0.1, 0.0]
*   **Лівий кульшовий суглоб (23):** [-0.1, 0.6, 0.1]
*   **Ліве коліно (25):** [-0.1, 0.2, 0.1]
*   **Ліва щиколотка (27):** [-0.1, 0.0, 0.1]
*   **Правий лікоть (14):** [0.2, 0.8, -0.2]
*   **Праве зап'ястя (16):** [0.2, 1.0, -0.2]

```
J_Warrior1_Real =
[ ...                        ...                        ...    ]
[ 0.100                      0.500                      0.000 ]  # Праве стегно (24)
[ 0.100                      0.200                      -0.100]  # Праве коліно (26)
[ 0.100                      0.100                      0.000 ]  # Права щиколотка (28)
[ -0.100                     0.600                      0.100 ]  # Ліве стегно (23)
[ -0.100                     0.200                      0.100 ]  # Ліве коліно (25)
[ -0.100                     0.000                      0.100 ]  # Ліва щиколотка (27)
[ 0.200                      0.800                      -0.200]  # Правий лікоть (14)
[ 0.200                      1.000                      -0.200]  # Праве зап'ястя (16)
[ ...                        ...                        ...    ]
```

### 4.2. Поза Воїна II (Virabhadrasana II)

**Текстовий опис вправи:**
Поза Воїна II – це поза стоячи, яка відкриває стегна, зміцнює ноги, розширює грудну клітку та покращує рівновагу.
-   Права нога (передня) зігнута в коліні під кутом приблизно 90 градусів, стегно паралельно підлозі, коліно знаходиться прямо над щиколоткою.
-   Ліва нога (задня) пряма, стопа повністю притиснута до підлоги, розвернута під кутом 90 градусів до передньої ноги.
-   Стегна відкриті, дивляться убік (паралельно довгій стороні килимка).
-   Корпус спрямований вбік, паралельно стегнам.
-   Руки витягнуті в сторони на рівні плечей, паралельно підлозі, долоні дивляться вниз.
-   Погляд спрямований поверх пальців передньої руки.

#### 4.2.1. Матричний опис суглобів для Пози Воїна II

**Варіант 1: Матриця координат суглобів**

Порівняно з Позою Воїна I, ключові відмінності будуть у координатах стегон, корпусу та рук. Стегна будуть розвернуті.

```
J_Warrior2 = 
[ x_nose   y_nose   z_nose   ]
[ ...      ...      ...      ]
[ x_lshoulder y_lshoulder z_lshoulder ] (руки витягнуті в сторони, Y-координати нижчі, X-координати відрізняються)
[ x_rshoulder y_rshoulder z_rshoulder ] 
[ x_lhip    y_lhip    z_lhip    ] (ліве стегно ззаду і вбік)
[ x_rhip    y_rhip    z_rhip    ] (праве стегно спереду і вбік)
[ x_lknee   y_lknee   z_lknee   ] (ліве коліно пряме, ззаду, вбік)
[ x_rknee   y_rknee   z_rknee   ] (праве коліно зігнуте 90 градусів, спереду, вбік)
[ x_lankle  y_lankle  z_lankle  ] (ліва щиколотка ззаду, вбік)
[ x_rankle  y_rankle  z_rankle  ] (права щиколотка спереду, вбік)
[ ...      ...      ...      ]
```
Приклад реальних значень кутів (для правильної пози):
-   **Праве коліно:** Кут згинання близько 90 градусів.
-   **Ліве коліно:** Кут згинання близько 180 градусів (пряма нога).
-   **Ліва стопа:** Обертання назовні 90 градусів відносно передньої ноги.
-   **Стегна:** Обертання стегнового поясу значне, орієнтовані вбік.
-   **Руки:** Кут між верхньою частиною руки та корпусом близько 90 градусів (руки витягнуті в сторони).

**Варіант 2: Матриця векторів сегментів тіла**

Вектори для Пози Воїна II будуть відображати розкриття стегон та рук у сторони.
Наприклад, `V_R_Hip_Knee` та `V_R_Knee_Ankle` залишаться майже перпендикулярними, але їх орієнтація у просторі зміниться. Вектор від `лівого плеча` до `лівого зап'ястя` (`V_L_Shoulder_Wrist`) і від `правого плеча` до `правого зап'ястя` (`V_R_Shoulder_Wrist`) будуть майже горизонтальними та протилежно спрямованими.

```
V_Warrior2 = 
[ dx_L_H_K dy_L_H_K dz_L_H_K ] 
[ dx_R_H_K dy_R_H_K dz_R_H_K ] 
[ dx_L_S_W dy_L_S_W dz_L_S_W ] (Ліве плече-зап'ястя, витягнута рука)
[ dx_R_S_W dy_R_S_W dz_R_S_W ] (Праве плече-зап'ястя, витягнута рука)
[ ...                             ...       ...     ]
```

**Варіант 3: Матриця трансформації**

Тут також використовуються ієрархічні матриці трансформації. Ключовою відмінністю від Пози Воїна I буде обертання в `T_Global_Pelvis` (або в `T_Pelvis_R_Hip` та `T_Pelvis_L_Hip`) для відображення відкритості стегон, а також матриці обертання для рук, що витягуються в сторони.

#### 4.2.2. Приклад матриці з реальними значеннями для Пози Воїна II (для Варіанта 1 - Матриця координат)

Припустимо, ми виміряли координати для ідеальної Пози Воїна II (передня права нога):

**Приклад (спрощені та ілюстративні значення, в одиницях MediaPipe):**
*   **Правий кульшовий суглоб (24):** [0.0, 0.5, -0.1]
*   **Праве коліно (26):** [0.0, 0.2, -0.2]
*   **Права щиколотка (28):** [0.0, 0.1, -0.1]
*   **Лівий кульшовий суглоб (23):** [0.2, 0.6, 0.1]
*   **Ліве коліно (25):** [0.2, 0.2, 0.1]
*   **Ліва щиколотка (27):** [0.2, 0.0, 0.1]
*   **Правий лікоть (14):** [-0.4, 0.7, 0.0]
*   **Праве зап'ястя (16):** [-0.6, 0.7, 0.0]
*   **Лівий лікоть (13):** [0.4, 0.7, 0.0]
*   **Ліве зап'ястя (15):** [0.6, 0.7, 0.0]

```
J_Warrior2_Real =
[ ...                        ...                        ...    ]
[ 0.000                      0.500                      -0.100]  # Праве стегно (24)
[ 0.000                      0.200                      -0.200]  # Праве коліно (26)
[ 0.000                      0.100                      -0.100]  # Права щиколотка (28)
[ 0.200                      0.600                      0.100 ]  # Ліве стегно (23)
[ 0.200                      0.200                      0.100 ]  # Ліве коліно (25)
[ 0.200                      0.000                      0.100 ]  # Ліва щиколотка (27)
[ -0.400                     0.700                      0.000 ]  # Правий лікоть (14)
[ -0.600                     0.700                      0.000 ]  # Праве зап'ястя (16)
[ 0.400                      0.700                      0.000 ]  # Лівий лікоть (13)
[ 0.600                      0.700                      0.000 ]  # Ліве зап'ястя (15)
[ ...                        ...                        ...    ]
```

## 5. Докладний аналіз переваг та недоліків варіантів опису

### Варіант 1: Матриця координат суглобів

**Переваги:**
*   **Простота:** Найпростіший для розуміння та реалізації. Дані з MediaPipe безпосередньо відповідають структурі матриці.
*   **Пряме порівняння:** Легко порівнювати пози, віднімаючи матриці координат. Норма різниці може вказувати на відхилення пози.
*   **Вихідні дані:** Безпосередньо використовує вихідні дані (x,y,z) від MediaPipe без додаткових обчислень.

**Недоліки:**
*   **Залежність від положення:** Координати абсолютно залежать від позиції людини у кадрі. Якщо людина відійде або наблизиться до камери, всі координати зміняться, хоча сама поза може бути ідеальною. Це вимагає додаткової нормалізації або центрівки скелета.
*   **Складність аналізу кутів:** Прямий аналіз кутів потребує додаткових обчислень векторів і кутів між ними, що не є вбудованим у цю матрицю.
*   **Недостатня інформація про орієнтацію:** Не надає інформації про обертання або орієнтацію сегментів тіла.

### Варіант 2: Матриця векторів сегментів тіла

**Переваги:**
*   **Відносна інформація:** Представляє взаємне розташування суглобів, що робить її менш чутливою до абсолютного положення людини у кадрі (якщо тільки не змінюється перспектива).
*   **Легкий розрахунок довжин:** Довжини сегментів тіла легко обчислюються з цих векторів.
*   **Основа для кутів:** Ці вектори є чудовою основою для обчислення кутів між сегментами тіла, що є критично важливим для оцінки йога-поз.

**Недоліки:**
*   **Втрата абсолютної позиції:** Не зберігає інформацію про абсолютне положення скелета, що може бути потрібним для візуалізації.
*   **Залежність від вибору сегментів:** Ефективність залежить від того, наскільки добре обрані сегменти для представлення.
*   **Still perspective dependent:** Хоча менш чутлива до переміщення, все ще може бути чутливою до зміни перспективи (нахилу камери).

### Варіант 3: Матриця трансформації (Homogeneous Transformation Matrix)

**Переваги:**
*   **Комплексне представлення:** Одночасно представляє і положення, і орієнтацію суглобів. Це ідеально підходить для опису кінематики тіла.
*   **Ієрархічний опис:** Дозволяє побудувати кінематичний ланцюг, де положення та орієнтація кожного суглоба визначаються відносно його "батьківського" суглоба.
*   **Незалежність від положення/орієнтації у кадрі:** Якщо перша матриця в ланцюгу (наприклад, `T_Global_Pelvis`) може бути адаптована (наприклад, шляхом центрівки), то відносні трансформації будуть незалежними від глобальної позиції та орієнтації людини.
*   **Прямий розрахунок кутів:** Матриця обертання (частина 4x4 матриці) може бути безпосередньо використана для вилучення кутів Ейлера, кватерніонів або осі-кута, які є ключовими для опису поз.
*   **Операції композиції:** Легко виконувати операції композиції (множення матриць) для обчислення кінцевого положення та орієнтації будь-якого суглоба в глобальній системі координат.

**Недоліки:**
*   **Складність реалізації:** Найскладніший варіант для реалізації, вимагає знання кінематики та перетворення координат. Потрібно обчислювати матриці обертання на основі координат MediaPipe, що вимагає розрахунку векторів та кутів між ними.
*   **Великий обсяг даних:** Кожна трансформаційна матриця 4x4 містить 16 елементів, що значно більше, ніж просто координати.
*   **Обчислювальні витрати:** Множення матриць є більш обчислювально дорогим, ніж прості операції з координатами.

### Порівняльний аналіз

| Ознака / Варіант           | Матриця координат суглобів | Матриця векторів сегментів тіла | Матриця трансформації |
| :------------------------- | :-------------------------- | :------------------------------ | :-------------------- |
| **Простота**               | Дуже висока                 | Висока                          | Низька                |
| **Залежність від позиції** | Висока                      | Середня (відносна)              | Низька (після нормалізації) |
| **Інформація про орієнтацію** | Відсутня                    | Опосередкована (через вектори)  | Висока (пряма)        |
| **Розрахунок кутів**       | Потребує додаткових обчислень | Легкий                           | Прямий (з матриці обертання) |
| **Обчислювальна складність** | Низька                      | Середня                         | Висока                |
| **Об'єм даних**            | Середній (33х3)             | Середній (кількість_сегментів х 3) | Високий (кількість_сегментів х 16) |
| **Для візуалізації**       | Прямо використовується       | Потребує інтеграції             | Прямо використовується (для відносних систем) |
| **Для корекції пози**      | Потребує аналізу різниць    | Відмінно підходить для кутів    | Відмінно підходить для кутів та руху |

**Висновок:** Для простого порівняння координат "як є", **Матриця координат суглобів** є найпростішою. Однак, для глибокого аналізу поз, що включає кути та орієнтацію, особливо для надання точних рекомендацій, **Матриця трансформації** є найбільш повною і потужною, незважаючи на її складність. **Матриця векторів сегментів тіла** є компромісним варіантом, який забезпечує відносну інформацію та є хорошою проміжною ланкою для розрахунку кутів. Для цілей "Віртуальної Йоги" з її завданням "слідкує за зміною координат розташування суглобів людини та надає рекомендації щодо правильного напрямку змини положення", підхід, що базується на кутах (отриманих з векторів або матриць трансформації), є найбільш доцільним.

## 6. Приклади комбінованих матриць для аналізу пози

Комбіновані матриці дозволяють об'єднувати різні аспекти даних або інформацію з різних частин тіла для комплексного аналізу.

### Приклад 1: Об'єднання координат та впевненості (для Варіанта 1)

MediaPipe надає не тільки координати, а й "оцінку видимості" (visibility score) для кожного суглоба. Цю інформацію можна додати до матриці координат.

```
J_Combined = 
[ x_nose   y_nose   z_nose   vis_nose   ]
[ x_leye_i y_leye_i z_leye_i vis_leye_i ]
[ ...      ...      ...      ...        ]
```
Це була б матриця `33x4`. Колонка `vis` (visibility) дозволить враховувати, наскільки надійно розпізнаний суглоб при аналізі.

### Приклад 2: Матриця кутів та довжин сегментів (для Варіанта 2)

Ми можемо комбінувати інформацію про кути між сегментами тіла та їхні довжини в одній матриці.
Наприклад, для кінцівок можна визначити:
-   `Theta_XY`: Кут сегмента з віссю X у площині XY.
-   `Theta_YZ`: Кут сегмента з віссю Y у площині YZ.
-   `Length`: Довжина сегмента.

```
Limb_Matrix = 
[ Angle_R_Hip_Knee_XY Angle_R_Hip_Knee_YZ Length_R_Hip_Knee ]
[ Angle_R_Knee_Ankle_XY Angle_R_Knee_Ankle_YZ Length_R_Knee_Ankle ]
[ ...                             ...                         ...     ]
```
Ця матриця агрегує ключові параметри, важливі для оцінки пози.

### Приклад 3: Матриця відхилень від еталонної пози

Після обчислення координат, векторів або трансформацій для поточної пози користувача (`J_Current`) та еталонної пози (`J_Reference`), можна створити матрицю відхилень.

`D_Coordinates = J_Current - J_Reference`

Де кожен елемент `D_ij` буде показувати відхилення координати `j` для суглоба `i` від еталонної. Ця матриця є ключовою для надання рекомендацій. Наприклад, якщо `D_R_Knee_x` є позитивним, це може означати, що праве коліно занадто зміщене вправо порівняно з еталоном.

## 7. Приклади підматриць для аналізу конкретних частин тіла

Підматриці дозволяють зосередитись на певних частинах тіла, ігноруючи інші, що є корисним для деталізованого аналізу або для поз, які акцентують увагу на конкретних зонах.

### Приклад 1: Підматриця для правої ноги (з Матриці координат суглобів)

Для аналізу тільки правої ноги (суглоби: праве стегно, праве коліно, права щиколотка, права п'ята, індекс правої стопи):
```
Sub_Matrix_R_Leg = 
[ x_rhip    y_rhip    z_rhip    ]
[ x_rknee   y_rknee   z_rknee   ]
[ x_rankle  y_rankle  z_rankle  ]
[ x_rheel   y_rheel   z_rheel   ]
[ x_rfoot_i y_rfoot_i z_rfoot_i ]
```
Це була б матриця `5x3`.

### Приклад 2: Підматриця для верхнього поясу (з Матриці векторів сегментів тіла)

Для аналізу верхньої частини тіла (наприклад, плечі, лікті, зап'ястя):
```
Sub_Matrix_UpperBody_Vectors = 
[ dx_L_Shoulder_Elbow dy_L_Shoulder_Elbow dz_L_Shoulder_Elbow ]
[ dx_L_Elbow_Wrist    dy_L_Elbow_Wrist    dz_L_Elbow_Wrist    ]
[ dx_R_Shoulder_Elbow dy_R_Shoulder_Elbow dz_R_Shoulder_Elbow ]
[ dx_R_Elbow_Wrist    dy_R_Elbow_Wrist    dz_R_Elbow_Wrist    ]
```
Ця матриця дозволила б легко обчислити кути у плечових та ліктьових суглобах.

### Приклад 3: Підматриця трансформації для руки (з Матриці трансформації)

Якщо ми використовуємо матриці трансформації, то підматрицею може бути послідовність матриць для одного кінематичного ланцюга, наприклад, для лівої руки:
`T_Left_Arm = [ T_Torso_L_Shoulder, T_L_Shoulder_L_Elbow, T_L_Elbow_L_Wrist ]`
Множення цих матриць дасть загальну трансформацію лівого зап'ястя відносно торса:
`T_Torso_L_Wrist = T_Torso_L_Shoulder * T_L_Shoulder_L_Elbow * T_L_Elbow_L_Wrist`

## 8. Приклади матриць із реальними значеннями для кожної вправи (розширено)

Ми вже надали приклади матриць координат для обох поз. Тепер зосередимося на прикладах для Варіанта 2 (Матриця векторів сегментів тіла), оскільки вони безпосередньо призводять до розрахунку кутів, що є важливим для йога-поз.

### Поза Воїна I (Virabhadrasana I)

**Матриця векторів сегментів (ілюстративні значення компонентів вектора):**
Припустимо, ми виміряли координати і обчислили вектори для ключових сегментів тіла.
*   Координати (спрощено, відцентровано, умовні одиниці):
    *   Правий кульшовий суглоб (24): [0.0, 0.0, 0.0] (точка відліку)
    *   Праве коліно (26): [0.0, -0.3, -0.3]
    *   Права щиколотка (28): [0.0, -0.6, 0.0]
    *   Лівий кульшовий суглоб (23): [-0.4, 0.1, 0.4]
    *   Ліве коліно (25): [-0.4, -0.3, 0.4]
    *   Ліва щиколотка (27): [-0.4, -0.7, 0.4]
    *   Правий лікоть (14): [0.1, 0.3, -0.1]
    *   Праве зап'ястя (16): [0.1, 0.6, -0.1]

**Обчислені вектори:**
*   `V_R_Hip_Knee` (24->26): [0.0, -0.3, -0.3]
*   `V_R_Knee_Ankle` (26->28): [0.0, -0.3, 0.3]
*   `V_L_Hip_Knee` (23->25): [0.0, -0.4, 0.0]
*   `V_L_Knee_Ankle` (25->27): [0.0, -0.4, 0.0]
*   `V_R_Shoulder_Elbow` (12->14, припустимо плече [0.0, 0.2, 0.0]): [0.1, 0.1, -0.1]
*   `V_R_Elbow_Wrist` (14->16): [0.0, 0.3, 0.0]

```
V_Warrior1_Real_Segments = 
[ 0.0  -0.3  -0.3 ] # V_R_Hip_Knee
[ 0.0  -0.3   0.3 ] # V_R_Knee_Ankle
[ 0.0  -0.4   0.0 ] # V_L_Hip_Knee
[ 0.0  -0.4   0.0 ] # V_L_Knee_Ankle
[ 0.1   0.1  -0.1 ] # V_R_Shoulder_Elbow
[ 0.0   0.3   0.0 ] # V_R_Elbow_Wrist
# ... та інші вектори
```

### Поза Воїна II (Virabhadrasana II)

**Матриця векторів сегментів (ілюстративні значення компонентів вектора):**
*   Координати (спрощено, відцентровано, умовні одиниці):
    *   Правий кульшовий суглоб (24): [0.0, 0.0, 0.0] (точка відліку)
    *   Праве коліно (26): [0.0, -0.3, -0.3]
    *   Права щиколотка (28): [0.0, -0.6, 0.0]
    *   Лівий кульшовий суглоб (23): [0.4, 0.1, 0.0]
    *   Ліве коліно (25): [0.4, -0.3, 0.0]
    *   Ліва щиколотка (27): [0.4, -0.7, 0.0]
    *   Правий лікоть (14): [-0.3, 0.1, 0.0]
    *   Праве зап'ястя (16): [-0.6, 0.1, 0.0]
    *   Лівий лікоть (13): [0.3, 0.1, 0.0]
    *   Ліве зап'ястя (15): [0.6, 0.1, 0.0]

**Обчислені вектори:**
*   `V_R_Hip_Knee` (24->26): [0.0, -0.3, -0.3]
*   `V_R_Knee_Ankle` (26->28): [0.0, -0.3, 0.3]
*   `V_L_Hip_Knee` (23->25): [0.0, -0.4, 0.0]
*   `V_L_Knee_Ankle` (25->27): [0.0, -0.4, 0.0]
*   `V_R_Shoulder_Elbow` (12->14, припустимо плече [0.0, 0.2, 0.0]): [-0.3, -0.1, 0.0]
*   `V_R_Elbow_Wrist` (14->16): [-0.3, 0.0, 0.0]
*   `V_L_Shoulder_Elbow` (11->13, припустимо плече [0.0, 0.2, 0.0]): [0.3, -0.1, 0.0]
*   `V_L_Elbow_Wrist` (13->15): [0.3, 0.0, 0.0]

```
V_Warrior2_Real_Segments = 
[ 0.0  -0.3  -0.3 ] # V_R_Hip_Knee
[ 0.0  -0.3   0.3 ] # V_R_Knee_Ankle
[ 0.0  -0.4   0.0 ] # V_L_Hip_Knee
[ 0.0  -0.4   0.0 ] # V_L_Knee_Ankle
[-0.3  -0.1   0.0 ] # V_R_Shoulder_Elbow
[-0.3   0.0   0.0 ] # V_R_Elbow_Wrist
[ 0.3  -0.1   0.0 ] # V_L_Shoulder_Elbow
[ 0.3   0.0   0.0 ] # V_L_Elbow_Wrist
# ... та інші вектори
```
З цих векторів можна легко обчислювати кути між ними (за допомогою скалярного добутку), що є основним критерієм для оцінки правильної йога-пози. Наприклад, кут між `V_R_Hip_Knee` та `V_R_Knee_Ankle` для Пози Воїна I та II повинен бути близько 90 градусів.

Це комплексний опис, який демонструє, як матриці можуть бути застосовані для представлення та аналізу даних про рух людини у "Віртуальній Йозі", пов'язуючи теорію вищої математики з практичними потребами IT-проєкту.