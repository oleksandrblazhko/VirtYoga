14. Екстремуми функції кількох змінних, необхідні
і достатні умови
Легкість математики заснована на можливості
чисто логічної її побудови, труднощі, які відляку-
ють багатьох, – на неможливості іншого викладу.
Хьюго Штейнгаус
Мета: засвоєння майбутніми фахівцями основних аналітичних ме-
тодів дослідження функцій кількох змінних на екстремум.
Питання теми:
14.1. Локальні екстремуми ФКЗ. Необхідна та достатня умови екст-
ремуму.
14.2. Найменше та найбільше значення функції на замкненій облас-
ті (тотальний екстремум).
14.3. Умовні екстремуми ФКЗ. Методи відшукання.
14.4. Поняття про емпіричні формули, метод найменших квадратів.
Компетентності, що формуються після вивчення теми:
Загальнонаукова: володіння методами дослідження функцій кіль-
кох змінних на екстремум.
Загальнопрофесійна: підготовленість до дослідження на екстремум
інформаційних параметрів як функцій кількох змінних.
Спеціалізовано-професійна: уміння будувати математичні моделі
для оптимізації управління інформаційними системами.
14.1. Локальні екстремуми ФКЗ. Необхідна та достатня умови
екстремуму
Нехай Ф2З z = f (x, y) визначена у точці ( ) M0 x0.y0 і деякому її
e-околі ( ) B e,M0 , що належить множині ( ) D Í D f Í R2 . Точка M0 на-
зивається точкою локального максимуму (мінімуму) функції, якщо
для всіх точок деякого e-околу цієї точки вартості функції менші (більші)
значення функції у самій точці:
( ) x0, y0 – точка max (min) $e > 0 Ù ( ) ( ) " x, y ÎB e,M0 :
( ) ( ) ( ) f x, y < > f x0, y0 .
(14.1.1)
179
Терміни „максимум” (від. лат. maximum – найбільше) та „мінімум”
(від лат. minimum – найменше) об’єднуються загальною назвою екстре-
мум (від лат. extremum – крайній, надзвичайний); а термін „локальний”
походить від лат. localis – місцевий.
Якщо для координат точок околу (x, y) покласти x = x0 + Dx ,
y = y0 + Dy , де Dx , Dy – прирости аргументів у межах околу точки M0 ,
то нерівності із (14.1.1) набудуть вигляду:
f (x0 + Dx, y0 + Dy)- f (x0, y0 ) < 0, або Df (x0, y0 ) < 0;
f (x0 + Dx, y0 + Dy)- f (x0, y0 ) > 0, або Df (x0, y0 ) > 0 .
(14.1.2)
Таким чином, якщо ( ) x0, y0 – точка локального максимуму (мініму-
му), то в деякому околі цієї точки повний приріст функції від’ємний (додат-
ний) і навпаки (сформулюйте, як це):
( ) x0, y0 – точка max (min) Û Df (x0, y0 ) < 0 (Df (x0, y0 ) > 0). (14.1.3)
Співвідношення (14.1.3) можна покласти в основу означення точок
локального екстремуму. Надалі для скорочення висловлень і записів тер-
мін „локальний” будемо проминати, якщо це не буде викликати непоро-
зумінь.
Вартості функції у точках екстремуму називають екстремумами
функції; відповідно – максимумом ( ) fmax або мінімумом функції
( ) fmin (рис. 14.1.1).
а) б)
Рис. 14.1.1. Екстремуми Ф2З: а) максимум; б) мінімум
180
Означення точок локального екстремуму (і екстремумів ФКЗ) для
функції довільного скінченного числа n (n > 2) аргументів u = f (M ), де
( ) M = M x1, x2,..., xn , або ( ) u = f x1, x2,..., xn , нічим принципово не відріз-
няється від (14.1.1), (14.1.3) і в символах подається так:
M0 – точка max (min) ( ) $e > 0 Ù"M ÎB e,M0 :
( ) ( ) ( ) f M < > f M0 ;
(14.1.4)
M0 – точка max (min) Û Df (M0 ) < 0 (Df (M0 ) > 0). (14.1.5)
(Наведіть словесне формулювання співвідношень (14.1.4), (14.1.5).)
Теорема 14.1.1 (необхідна умова екстремуму). Якщо функція кіль-
кох змінних ( ) u = f x1, x2,..., xn у деякій точці ( ) 0 0
2
0
M0 x1 , x ,..., xn має екс-
тремум, то у цій точці кожна її частинна похідна дорівнює нулю або не
існує:
M0 – точка extr ⇒ "iÎ{1, 2,.., n }: f ¢ (M0 ) = 0Ú f ¢ (M0 ) $
xi xi . (14.1.6)
Д о в е д е н н я базується на необхідній умові екстремуму Ф1З
(див. (10.4.11) частини 1).
Зафіксуємо у функції u = f (M ) усі аргументи, крім одного, напри-
клад, x1, поклавши їх рівними координатам точки M0 : 0
xi = xi , i = 2, n .
Тоді отримаємо Ф1З ( ) ( ) 0 0
j x1 = f x1, x2 ,... , xn , яка має екстремум при
0
x1 = x1 . Похідна
j¢x1 у точці
0
x1 = x1 є водночас ч/п функції
( ) u = f x1, x2,..., xn у точці M0 : ( ) 0 1 0
1 1 1
fx M x x x j¢ = ¢
=
. Отже, згідно з необ-
хідною умовою екстремуму Ф1З ( ) 1 0
fx M ¢ дорівнює нулю або не існує.
За допомогою аналогічних міркувань (наведіть їх) отримуємо, що
"iÎ{2,3,..., n }: f ¢ (M0 ) = 0 Ú f ¢ (M0 ) $
xi xi .
Внутрішні точки області визначення функції, в яких виконується не-
обхідна умова екстремуму, називають критичними. Якщо у критичній
точці функція диференційовна, то така точка називається стаціонар-
ною. Звичайно, у стаціонарній точці f ¢ (M0 ) = 0
xi "i =1, n.
181
Прикладом нестаціонарної точки
є O(0,0) – точка максимуму ( fmax = 0)
для функції
z = - x2 + y2 , яка описує
нижню половину конічної поверхні
(рис. 14.1.2).
Ця ж сама точка не є точкою екс-
тремуму, якщо розглядати усю конічну
поверхню 0 x2 + y2 - z2 = (чому?). Рис. 14.1.2. Конічна поверхня
Згідно з теоремою 14.1.1 у технічному плані відшукання критич-
них точок ФКЗ зводиться до розв’язання системи рівнянь
f ¢ (M) = 0
xi , i =1,n,
і установлення точок із D( f ), у яких частинні похідні не існують.
Приклад. Знайти критичні точки Ф2З
z = (1+ x) y - 0,5x - y2 .
Область існування D( f ) = {(x, y) yÎR Ù x ³ 0 } (чому?).
Здійснюємо частинне диференціювання:
2
1
2
¢ = × 1 -
x
zx y , z¢y = 1+ x - 2 y .
Складаємо систему рівнянь, лівими частинами яких є ч/п, і
розв’язуємо її:
  
+ - =
- =
1 2 0
1 0,
x y
y x
⇒
  
- =
=
1 0
,
x
y x
⇒ 

=
=
1
1,
y
x
⇒
⇒ M0 (1,1) – критична точка, яка є стаціонарною.
Установлюємо точки, у яких частинні похідні не існують: похідна за
y існує на усій D( f ), а ч/п за x не існує при x = 0; проте точка
N0 (0,1 2) не є критичною, бо лежить не всередині, а на межі області іс-
нування (то й що?).
Таким чином, функція має одну стаціонарну точку. Але чи є вона
точкою екстремуму?
182
Відповідь на це запитання дамо після розгляду достатньої умови
екстремуму, установлення якої для ФКЗ зводиться до аналізу повного
диференціала 2-го порядку у стаціонарній точці M0 :
( 0) 0
d 2 f M > ⇒ ( ) 0 Df M0 > ⇒ M0 – точка extr . (14.1.7)
Зважаючи на складність відповідної теореми, приймемо її без до-
ведення, обмежуючись випадком Ф2З.
Нехай функція z = f (x, y) визначена, неперервна і має неперервні
ч/п першого і другого порядків у деякому околі стаціонарної точки
( ) M0 x0.y0 , тобто двічі диференційовна у точці ( ) M0 x0.y0 .
Проробимо таке:
1) знайдемо другі ч/п у точці M0 :
fx¢¢x (M0 ) = A, fx¢¢y (M0 ) = f y¢¢x (M0 ) = B, f y¢¢y (M0 ) = C , (14.1.8)
де через A, B, C позначено їхні числові вартості;
2) складемо визначник ( ) D M0 2-го порядку, елементами головної
діагоналі якого є числа A, C , а побічної – число B, і обчислимо його:
( )
( ) ( )
( ) ( )
2
0 0
0 0
0 AC B
B C
A B
f M f M
f M f M
M
yx yy
xx xy = = -
¢¢ ¢¢
¢¢ ¢¢
D = . (14.1.9)
Теорема 14.1.2 (достатня умова екстремуму). Якщо функція
z = f (x, y) двічі диференційовна у стаціонарній точці ( ) M0 x0.y0 і визнач-
ник D у цій точці додатний, то ( ) M0 x0.y0 є точкою екстремуму:
  


D >
$ ¢¢ ¢¢ ¢¢ ¢¢
-
( ) 0
, , ,
0
0
0 0 0 0
M
f f f f
M
xx M xy M yx M yy M ,
стаціонарна точка,
⇒ M0 – точка extr , (14.1.10)
до того ж:
fx¢¢x (M0 ) = A > 0 ⇒ M0 – точка min ;
fx¢¢x (M0 ) = A < 0 ⇒ M0 – точка max.
(14.1.11)
183
Для інших випадків значень D = D(M0) установлено:
D < 0 ⇒ M0 не є точкою extr ;
D = 0 ⇒ екстремум у M0 може бути, а може і не бути.
(14.1.12)
Цей, „сумнівний”, випадок потребує глибокого аналізу диференціа-
лів більш високих порядків (або досліджується повний приріст функції
(див. (14.1.3)), як і у випадку нестаціонарних критичних точок).
Приклад. Дослідити функцію
z = (1+ x) y - 0,5x - y2 на локальний
екстремум (див. приклад вище).
Дослідження потребує двох кроків: 1) відшукання критичних точок;
2) перевірка виконання достатньої умови (14.1.10).
Стаціонарною критичною точкою є M0 (1,1). Знаходимо у цій точці
ч/п 2-го порядку:
( ) 3 2
2 4
1
2
1 = - -
¢
 


 


¢¢ = ¢ ¢ = × - x
y
x
z z y
xx x x x ⇒
4
1
0
= ¢¢ = - A zxx M ;
x x
z z y
xy yx y 2
1
2
1
2
1 =
¢
 


 


¢¢ = ¢¢ = × - ⇒
2
1
0
= ¢¢ =
xy M B z ;
¢¢ = ( ¢ )¢ = (1+ - 2 )¢ = -2 z yy z y y x y y ⇒ 2
0
= ¢¢ = -
yy M C z .
Рис. 14.1.3. Точка максимуму Ф2З
і сам максимум
Перевіряємо, чи виконується
достатня умова екстремуму, для
чого складаємо і обчислюємо ви-
значник D:
0,25 0
0,5 2
0,25 0,5 = >
-
D = = -
B C
A B
.
Згідно з (14.1.10) екстремум є і
до того ж максимум (чому?).
Таким чином, задана функція у
точці (1,1) має локальний макси-
мум (рис. 14.1.3): fmax = 0,5.
184
14.2. Найменше та найбільше значення функції на замкненій
області (тотальний екстремум)
Для ФКЗ, визначеної і неперервної в деякій обмеженій замкненій
області D Í D( f ) – області, якій належить її межа, – як і для функції од-
нієї змінної (див. теореми 8.4.4, 8.4.5 частини 1), справедливі теореми
про обмеженість і про найменше і найбільше значення неперервної
функції.
Точка M0 ÎD, у якій функція набуває найменшого (найбільшого)
значення, називається точкою тотального мінімуму (максимуму), а
відповідне значення функції – тотальним, або повсюдним, мінімумом
(максимумом) (тотальний від лат. totalis – увесь, цілий, повний).
Якщо точка M0 лежить всередині області, то можливі локальні екс-
тремуми визначаються критичними точками, проте тотального екстре-
муму функція може досягати і на межі області. Тому порядок відшукан-
ня тотальних екстремумів такий:
1) знаходять критичні точки і обчислюють значення функції у тих із
них, які лежать всередині розглядуваної області; перевіряти виконання
достатньої умови екстремуму немає потреби (чому?);
2) знаходять найменше і найбільше значення функції на лініях, які
складають межу області;
3) зіставляють значення функції, знайдені на кроках 1), 2), і виби-
рають серед них найменше f (M )
D
min і найбільше f (M)
D
max ; таких
значень функція може набувати у декількох точках.
За допомогою теорії максимумів та мінімумів ФКЗ розв’язуються
численні задачі з геометрії, механіки, економіки та інших наук.
Приклад. Знайти найбільше та найменше значення функції
z = x2 + y2 - xy - x - y
в області {( , ) 0, 0, 4} D = x y x ³ y ³ x2 + y2 £ .
Аналізуємо нерівності, які визначають область D:
x ³ 0 описує праву півплощину;
y ³ 0 відповідає множині точок верхньої півплощини;
x2 + y2 £ 4 – аналітичний образ круга радіуса 2 з центром O(0,0).
Описуємо лінії, які складають її межу: 0, 0, 4 x = y = x2 + y2 = , і зо-
бражуємо D на xOy (рис. 14.2.1).
185
Рис. 14.2.1. Область завдання
функції
Знаходимо критичні точки і обчис-
люємо значення функції у тих із них,
що лежать всередині D:
  
¢ =
¢ =
0
0,
y
x
z
z
⇒
  
- - =
- - =
2 1 0
2 1 0,
y x
x y
⇒
⇒
  
=
=
1
1,
y
x ⇒ ( ) 1,1 ÎD ⇒ f (1,1) = -1.
Досліджуємо поведінку функції на межі області, яка складається з
трьох ділянок: відрізки OA, OB осей координат і дуга кола È AB.
OA: (y = 0, 0 £ x £ 2) ⇒ z = x2 - x ⇒ z¢x = 2x -1 = 0 ⇒ x =1 2 ;
обчислюємо значення функції у точці (1 2,0) і на кінцях відрізка:
f (1 2,0) = -1 4; f (0,0) = 0 ; f (2,0) = 2.
Аналогічним чином (прослідкуйте) маємо:
OB : (x = 0, 0 £ y £ 2) ⇒ z = y2 - y ⇒ z¢y = 2 y -1 = 0 ⇒ y =1 2 ;
f (0,1 2) = -1 4 ; f (0, 2) = 2; f (0,0) уже обчислювалось.
È AB : (x2 + y2 = 4) ⇒ z = 4 - x - 4 - x2 (x +1) ⇒
⇒ ( ) 4 0
4
1
1 2
2
- - =
-
¢ = - + + x
x
x x
zx ⇒ x ¹ ±2 ⇒
⇒ приходимо до розв’язання ірраціонального рівняння ⇒
⇒ 4 - x2 = 2x2 + x - 4 ⇒ 2x4 + 2x3 - 7x2 - 4x + 6 = 0 ⇒
⇒ (2x2 + 2x - 3)(x2 - 2)= 0 ⇒
 

+ - =
- =
2 2 3 0
2 0,
2
2
x x
x
⇒
186
⇒
 


= - ±
= ±
2
1 7
2 ,
3,4
1, 2
x
x
⇒
 


= +
=
2
8 2 7
2 ,
3
1
y
y
⇒ 


»
» -
( , ) 1,80.
( , ) 0,83,
3 3
1 1
f x y
f x y
Рис. 14.2.2. Тотальні екстремуми
Вибираємо серед підкреслених
чисел найменше і найбільше, будує-
мо відповідні точки в системі xOyz
(рис. 14.2.2): min f (M)= -1
D
у стаціо-
нарній точці (1,1); max f (M) = 2
D
у
точках A(2,0) і B(0, 2) межі області.
Як бачимо, до точок тотальних
екстремумів не увійшли внутрішні
точки ділянок межі області D, зок-
рема точки дуги кола È AB (на
рис. 14.2.2 вона не зображена). (По-
думайте, яку поверхню описує до-
сліджена функція.)
14.3. Умовні екстремуми ФКЗ. Методи відшукання
Нехай функція z = f (M), де ( ) M = M x1, x2,..., xn , визначена в об-
ласті D Í D( f ) і задані додаткові умови – рівняння зв’язку, – яким по-
винні підкорятися аргументи: ji (x1, x2 ,..., xn ) = 0, i = 1,m, причому
m < n (чому?).
Точка M0 ÎD називається точкою відносного (або умовного)
локального максимуму (мінімуму) функції, якщо для всіх точок деякого
e-околу цієї точки з урахуванням рівнянь зв’язку вартості функції менші
(більші) значення функції у самій точці:
( ) x0, y0 – точка умовного max (min)
( ) ( )
( , ,..., ) 0 :
0: , , ,
0 1 2
0


j =
$e > " Î e
i x x xn M
x y B M ( ) ( ) ( ) f x, y < > f x0, y0 .
(14.3.1)
187
Вартості функції у точках умовного екстремуму називають умов-
ними екстремумами функції; відповідно – максимумом ( fmcax ) або мі-
німумом функції ( fmcin ); індекс c від лат. conditions – умова.
Приклад. Визначити найменше значення Ф2З ( ) 2 z = f x, y = x2 + y ,
якщо: а) (x, y)ÎR2 ; б) x - y = 2.
У випадку а) ніякі обмеження на значення аргументів не наклада-
ються: R2 є областю визначення функції. Найменше значення Ф2З легко
установити без аналітичного дослідження на екстремум: сума квадратів
двох чисел не може бути від’ємною, тому локальний мінімум буде у точці
O(0,0): zmin = 0; переконайтеся у цьому аналітичним шляхом.
У випадку б), коли треба враховувати рівняння зв’язку, яке в стан-
дартній неявній формі має вигляд: j = j(x, y) = x - y - 2 = 0, поступають
так:
1) розв’язують його, наприклад, відносно змінної y : y = x - 2. Тоді
( , 2) 2 ( 2)2 2( 2 2 2)
2 = - = + - = - + z = - f x x x x x x y x стає Ф1З;
2) досліджують на екстремум отриману функцію: критична точка
x = 1 є точкою локального мінімуму Ф1З (переконайтеся) і водночас ви-
значає точку умовного локального мінімуму Ф2З: M0 (1,-1), і сам умовний
мінімум: min = 2 f c .
Наведені вище кроки 1) і 2) описують порядок відшукання
f c min чи
f c max , якщо рівняння зв’язку розв’язуване відносно змінної x або y .
Зауваження:
якщо в (14.3.1) нерівності виконуються зі знаками „£” чи „³”, то
умовні екстремуми функції називають нестрогими;
на противагу умовним локальним екстремумам розглянуті вище ло-
кальні екстремуми (див. (14.1.1)) називають безумовними.
Висновок (узагальнення розглянутого на прикладі). Якщо рівнян-
ня зв’язку розв’язувані відносно кожної змінної (кількох змінних), то їх
можна розглядати як явне завдання функцій меншого числа аргументів
або навіть одного, і тоді вихідна ФКЗ подається складеною функцією
меншого числа аргументів. Наприклад, нехай для функції 3-х змінних
188
u = f (x1, x2, x3 ) маємо одне рівняння зв’язку j(x1, x2, x3 ) = 0 , тоді якщо з
нього ( ) x3 = y x1, x2 , то ( ( )) u = f x1, x2,y x1, x2 – Ф2З.
У разі двох додаткових умов: j1(x1, x2, x3 ) = 0 , j2 (x1, x2, x3 ) = 0
отримуємо: ( ( ) x3 = y1 x1, x2 , ( )) x3 = y2 x1, x2 ⇒ ( ( ) x2 = m x1 , ( )) x3 = n x1 , і
тоді маємо: ( ( ) ( )) u = f x1, m x1 , n x1 – Ф1З. (А якщо взяти три додаткові
умови?)
Таким чином, виходить, що задача умовного екстремуму зводить-
ся до розв’язання задачі на безумовний екстремум складеної функції.
Відповідний спосіб відшукання екстремуму
f c extr ФКЗ природно назвати
методом зведення до складеної, або зложеної, функції.
На жаль, такий підхід до визначення умовних екстремумів неспро-
можний, якщо рівняння зв’язку ji (x1, x2,..., xn ) = 0, i = 1,m, не припуска-
ють розв’язання їх відносно змінних x j , j =1,n . Тому необхідна і достат-
ня умови відносного локального екстремуму установлені саме для такого
випадку, хоча вони придатні і для явного завдання рівнянь зв’язку (на
якій підставі?). Наведемо відповідні твердження без доведення.
Теорема 14.3.1 (необхідна умова відносного екстремуму). Якщо
точка M0 є точкою локального умовного екстремуму при обмеженнях
ji (M) = 0, i =1,m, і числова матриця розміру m´ n , складена із ч/п
функцій ji (M) у точці M0 , має ранг r = m, то існують дійсні числа
l1, l2 , …, lm такі, що точка M0 є критичною точкою функції n змінних
F = f + l1j1 + l2j2 +...+ lmjm, (14.3.2)
де F = F(M), f = f (M), ji =ji (M):
( )
  


=  


 


¶
¶j
-
´
m
x
M
r
M f
j m n
i
c
0
0 точка extr
⇒ $li ÎR: .
1
0 Σ
=
- = + j
m
i
M кр. точка F f i (14.3.3)
Функція F і числа l1, l2 ,…, lm називаються відповідно функцією
Лагранжа і множниками Лагранжа.
189
Для Ф2З z = f (x, y) з рівнянням зв’язку j(x, y) = 0 матриця, скла-
дена із ч/п функцій j(M) у точці M0 , має розмір 1´ 2: ( ) j¢x j¢y , а для
u = f (x, y, z) з рівняннями зв’язку j1(x, y, z) = 0 і j2 (x, y, z) = 0 така:
   


   


¶
¶j
¶
¶j
¶
¶j
¶
¶j
¶
¶j
¶
¶j
=  


 


¶
¶j
´
x y z
x y z
x j
i
2 2 2
1 1 1
2 3
, де (x1, x2, x3 ) = (x, y, z). (14.3.4)
Наслідок (про достатні умови відносного екстремуму). Якщо
установлено, що 0 M – критична точка функції Σ
=
= + j
m
i
F f i
1
, то для неї
проводять дослідження згідно з (14.1.7), тобто на безумовний екстремум:
( 0 ) 0
d 2F M > ⇒ ( ) 0 DF M0 > ⇒ M0 – точка extr f (M). (14.3.5)
Для функції z = f (x, y) за аналогією з (14.1.9) достатня умова
відносного екстремуму з рівнянням зв’язку j(x, y) = 0 остаточно ви-
глядає так:
( ) 0
0
0 <
j¢ ¢¢ ¢¢
j¢ ¢¢ ¢¢
j¢ j¢
D =
y xy yy
x xx xy
x y
F F
M F F ( > 0) ⇒ M0 – точка min (max). (14.3.6)
На практиці часто оцінку того, чи є стаціонарна точка точкою міні-
муму або максимуму, здійснюють виходячи із смислу задачі.
На підставі викладеного дотримуються такого порядку дослідження
функцій на умовний екстремум (методом Лагранжа):
1. Складають функцію Лагранжа: F = f + l1j1 + l2j2 +...+ lmjm.
2. Відшукують її ч/п ,
x j F¢ j =1,n , і
i
Fl¢ , i =1,m.
3. Знаходять критичні точки функції F , для чого складають відпо-
відну систему рівнянь ( ¢ = 0, x j F j =1,n ; l¢ = 0 i
F , i =1,m), і розв’язують її;
при цьому якщо ( , , ..., , 1, 2 ,..., )
0 0
2
0
x1 x xn l l lm – критична точка для F(M),
то точка ( 0 0)
2
0
x1 , x ,..., xn є критичною для f (M).
190
4. Установлюють, чи є критична точка точкою екстремуму, для чо-
го досліджують знак другого диференціала d f (M) 2 (перевіряють вико-
нання достатніх умов) або повного приросту Df (M) в околі критичних
точок, або виходять із смислу задачі.
Зауваження: у спеціальних розділах вищої математики, наприклад
„Чисельні методи”, вивчаються наближені методи дослідження ФКЗ на
наявність тих чи інших екстремумів; широкий клас серед них складають
так звані градієнтні методи.
Приклади. 1. Знайти методом Лагранжа умовний екстремум функції
z = 2 - x2 - y2 , якщо x + y =1 (рис. 14.3.1).
Функція Лагранжа має вигляд:
F(x, y,l) = f (x, y)+ lj(x, y) ⇒ F = 2 - x2 - y2 + l(x + y -1).
Рис. 14.3.1. Умовний екстремум
Знаходимо її критичні точки:




¢ =
¢ =
¢ =
l 0
0
0
F
F
F
y
x
⇒



+ - =
- + l =
- + l =
1 0
2 0
2 0
x y
y
x
⇒
⇒



+ - =
= l
= l
1 0
2
2
x y
y
x
⇒



=
=
l =
1 2
1 2
1
y
x ⇒
⇒ M0 = M0 (1 2,1 2).
Залучаємо (14.3.6), підраховуючи ч/п у критичній точці:
( ) 4 0
1 0 2
1 2 0
0 0 1 1
0 = >
-
= -
j¢ ¢¢ ¢¢
j¢ ¢¢ ¢¢
j¢ j¢
D =
y xy yy
x xx xy
x y
F F
M F F ⇒
2
3
max = f c .
(Зіставте
f c max з fmax (див. рис. 14.3.1); розв’яжіть цей самий
приклад зведенням до дослідження на безумовний екстремум функції
однієї змінної.)
191
2. Дослідити на умовний екстремум функцію z (x ) y = -1 2 з рівнян-
ням зв’язку j(x, y) = x - y -1 = 0.
За методом Лагранжа маємо (коментар наведіть самостійно):
F = (x -1)2 y + l(x - y -1) ⇒ ( )



¢ = - - =
¢ = - - l =
¢ = - + l =
l 1 0
1 0
2( 1) 0
2
F x y
F x
F x y
y
x
⇒



- l =
+ l =
- =
0
2 0
1
2
2
y
y
x y
⇒
⇒ (y = 0, l = 0, x =1) ⇒ M0 (1,0) – критична точка ⇒
⇒ ( ) 0
1 0 0
1 0 0
0 0 1 1
0 =
-
-
=
j¢ ¢¢ ¢¢
j¢ ¢¢ ¢¢
j¢ j¢
D =
y xy yy
x xx xy
x y
F F
M F F ⇒ сумнівний випадок:
умовний екстремум може бути, а може не бути.
Проведемо дослідження приросту функції Dz у точці M0 (1,0):
Dz = f (x + Dx, y + Dy)- f (x, y) = (x + Dx -1)2 (y + Dy)- (x -1)2 y ⇒
⇒ Dz ( ) = Dx2 ×Dy
1,0 ⇒ 

D > ⇒D >
D < ⇒D <
0 0
0 0
y z
y z
⇒ екстремуму немає.
Такий самий результат отримаємо методом зведення до складеної
функції: розв’язати рівняння зв’язку відносно одного з аргументів, напри-
клад x , і перейти до дослідження на безумовний екстремум Ф1З:
x - y -1 = 0 ⇒ x = y +1 ⇒ z = y3 – Ф1З ⇒
⇒ z¢y = 3y2 = 0 ⇒ y = 0 – критична точка.
При переході через „нуль” похідна не змінює знак, отже, z = y3 не
має безумовного екстремуму, а Ф2З – умовного екстремуму в M0 (1,0).
14.4. Поняття про емпіричні формули, метод найменших квадратів
Нехай при дослідженні якогось явища або процесу (зокрема,
економічного) спостерігалися дві змінні величини x і y , у результаті чого
192
отримано n пар (x, y), які за звичаєм подаються у вигляді таблиці
(табл. 14.4.1).
Таблиця 14.4.1
Результати експерименту
x x1 x2 … xn
y y1 y2 … yn
Ставиться задача: за даними експерименту знайти наближену фун-
кціональну залежність y від x : y f (x)
~ = .
Функціональні залежності, які будуються за даними експерименту,
називаються емпіричними формулами (е/ф).
Р о з в’ я з а н н я задачі – побудова е/ф – реалізується в два етапи.
І. Вибір множини (класу) можливих функцій, якому належить за
припущенням (здогадкою) шукана залежність. Це здійснюється на основі
теоретичних міркувань або природи експерименту, або візуального ана-
лізу розташування точок на площині.
Як правило, той чи інший клас функцій характеризується кількома
числовими параметрами: a0 , a1, …, am , які вносять у символічне позна-
чення е/ф: ( ) y f x,a ,a ,...,am
~
= 0 1 . Наприклад, лінійна залежність y = kx +b
містить два параметри: k – кутовий коефіцієнт, b – величина відрізка,
який пряма відтинає на осі ординат; квадратична залежність описується
формулою, у якої три числових параметра: y = ax + bx + c 2 , де, як і ви-
ще, x – поточна змінна, а {a,b,c} – множина параметрів.
ІІ. Визначення числових параметрів е/ф: ( ) y f x,a ,a ,..., am
~
= 0 1 , які б
у певному сенсі найкращим чином описували явище (процес), що вивча-
ється дослідником.
Одним із широко відомих методів відшукання параметрів е/ф є ме-
тод найменших квадратів (МНК), суть якого полягає у такому:
різницю між експериментальними значеннями yi , i =1, n, і знайде-
ними за е/ф ( ) f x, a , a ,..., am
~
0 1 називають відхилом (наближених теоре-
тичних значень величини y від вихідних даних) і позначають через ei :
( ) yi - f xi , a , a ,..., am = ei
~
0 1 , i = 1,n ;
193
невідомі параметри е/ф вибирають так, щоб сума квадратів відхи-
лів була мінімальною:
( ( , , ,..., )) min.
~
1
2
0 1
1
= Σe2 = Σ - ®
= =
n
i
i i m
n
i
S i y f x a a a (14.4.1)
Сума S є функцією параметрів a j , j = 0,m: ( ) S = S a0, a1,..., am ,
яку і треба мінімізувати.
Порядок відшукання параметрів е/ф такий:
1) складають суму квадратів відхилів (14.4.1);
2) знаходять a j , j = 0,m, які забезпечують мінімальне значення
S. Для цього за необхідною умовою локального екстремуму складають
систему рівнянь ¶ = 0
¶
a j
S , j = 0,m, і розв’язують її. Доведено, що відпо-
відна стаціонарна точка є точкою мінімуму ФКЗ ( ) S = S a0,a1,..., am .
Приклад. Нехай f (x,a0,a1) a0 a1x
~ = + . Знайти параметри е/ф.
Функція ( ) 1 0,a a S S = має вигляд: ( ) Σ
=
= + -
n
i
S a a xi yi
1
2
0 1 , а система
рівнянь, яка визначає критичну точку, така:
( )
( ) 


 


¢ = + - × =
¢ = + - × =
Σ
Σ
=
=
n
i
a i i i
n
i
a i i
S a a x y x
S a a x y
1
0 1
1
0 1
2 0
2 1 0,
1
0
⇒
 

 


+ =
+ =
Σ Σ Σ
Σ Σ Σ
= = =
= = =
.
1 ,
1 1 1
2
0 1
1 1 1
0 1
n
i
n
i
i i
n
i
i i
n
i
n
i
i
n
i
i
a x a x x y
a a x y
Якщо ввести в розгляд арифметичні середні значень x , y , xy , x2:
Σx = x
n i
1 , 1Σx2 = x2
n i , Σ = y y
n i
1 , Σx y = xy
n i i
1 , де ,
1
Σ Σ
=
=
n
i
то приходимо до системи:



+ =
+ =
,
,
2
0 1
0 1
a x a x xy
a a x y
194
або в матричній формі:  


 


=  


 


×  


 


xy
y
a
a
x x
x
1
0
2
1
.
Ця система називається системою нормальних рівнянь для від-
шукання параметрів е/ф. Згідно з (14.4.1) розв’язок системи дає найкра-
щі значення шуканих параметрів і подається він такими формулами:
2 2
2
0
x x
x y x xy
a
-
= × - × , 1 2 2
x x
xy x y
a
-
= - × . (14.4.2)
У випадку, коли залежність між змінними y та x треба апроксиму-
вати функцією, яка не є лінійною, застосування методу найменших квад-
ратів потребує попередньої лінеаризації моделі – введення нових змін-
них таким чином, щоб залежність між цими новими змінними була ліній-
ною.
Наприклад, якщо залежність змінної y від змінної x описується гі-
перболічною функцією, тобто ( ) 1
, 0 , 1 0 1 f x a a = a + a x- , то вводять змінну
X = x-1, і складають систему нормальних рівнянь для пари (X , y).
Якщо залежність показникова: f (x,a0,a1) = a0 × a1x , функцію лінеа-
ризують логарифмуванням за будь-якою основою, наприклад, за десят-
ковою: lg y = lg a0 + lg a1 × x , покладають Y = lg y і будують е/ф за зна-
ченнями елементів пари (x, Y) . Після обчислення параметрів моделі
повертаються до вихідних змінних.
Зауваження. Існує простий спосіб уточнення емпіричної форму-
ли у тому випадку, якщо вона дає суму квадратів похибок більш значну,
ніж бажано. Розглядають нову функцію: y = y + c ~ , де c – деяка стала,
і підбирають число c так, щоб сума квадратів нових похибок була міні-
мальною:
( ~ ) ( ) min
1
2
1
2
1
= Σe2 = Σ - - = Σ e - ®
= = =
n
i
i
n
i
i i
n
i
S i y y c c .
Для мінімуму цієї функції необхідно, щоб
( ) Σ
= ¶ = e - =
¶ n
i
i c
c
S
1
2 0, відкіля: Σ Σ
= =
= e ⇒ = e
n
i
i
n
i
i n
nc c
1 1
1 .
195
Оскільки 2 0 2
2
= >
¶
¶ n
c
S , то знайдене значення c дає найменшу су-
му квадратів S .
Отже, найкращою сталою c є середнє арифметичне похибок ei ,
i =1,n. Звичайно, якщо c = 0 або близьке до нуля, то розглянутий спосіб
потрібного ефекту не дає.
Задача 14.4.1. За даними підприємства залежність між кількістю
продукції x (ум. од.), що випускається, і витратами виробництва на оди-
ницю продукції y (грн) подається таблицею (табл. 14.4.1). (Витрати на
одиницю продукції – це середні валові витрати, які дорівнюють загаль-
ним витратам, поділеним на обсяг виробництва товарів.)
Побудувати емпіричну формулу виробничої функції.
Таблиця 14.4.1
Значення змінних x і y
x 10,1 21,2 32,4 39,8 50,0 62,0 70,0
y 222,0 119,4 87,1 69,6 60,0 52,5 48,5
Р о з в’ я з а н н я. Зважаючи на те, що виробнича функція y = y(x)
у багатьох випадках описується степеневою функцією, емпіричну фор-
мулу будемо відшукувати у вигляді:
( ) 1
, 0 , 1 0
~ a y = f x a a = a × x , (14.4.3)
де a0 , a1 – числові параметри, які підлягають визначенню.
Лінеаризуємо логарифмуванням модель задачі:
ln y = ln a0 + a1 ln x ⇒
0 ln 0, 1 1
ln , ln ,
A a A a
Y y X x
= =
= = ⇒ Y = A0 + A1X .
Складаємо таблицю значень нових змінних X , Y (табл. 14.4.2).
Таблиця 14.4.2
Значення змінних X і Y
X 2.3125 3.0540 3.4782 3.6839 3.9120 4.1271 4.2485
Y 5.4027 4.7825 4.4671 4.2428 4.0943 3.9608 3.8816
196
Підраховуємо параметри системи нормальних рівнянь і обчислює-
мо за формулами (14.4.2) параметри емпіричної формули:
7,2157 2 2
2
0 »
-
= × - ×
X X
A X Y X XY , 0,7930 1 2 2 » -
-
= - ×
X X
A XY X Y ; (14.4.4)
і отримуємо рівняння прямої Y = A0 + A1X , яку назвемо спрямляючою;
отже, Y = 7,2 - 0,8X (рис 14.4.1-а).
Повертаємось до вихідних параметрів:
A0 = ln a0 ⇒ 1360,6 7,2157
a0 = e » ; a1 » -0,8;
і вихідних змінних x , y , і записуємо (14.4.3): ,8 ~y =1360,6× x-0 .
На рис. 14.4.1-б зображено теоретичну лінію і вихідні точки.
а) б)
Рис. 14.4.1. Графіки формул: а) спрямляючої; б) емпіричної
Уточнення емпіричної формули проводити нема потреби, бо теоре-
тична лінія досить переконливо узгоджується з точками результатів до-
слідження.
Зауваження. На практиці при виборі емпіричної формули керують-
ся правилом: якщо про вигляд залежності між величинами x і y із тео-
ретичних (чи інших) міркувань нічого невідомо, то із декількох варіантів
вибирають той, який краще узгоджується з експериментальними дани-
ми і має найменше число параметрів, а потім проводять уточнення.