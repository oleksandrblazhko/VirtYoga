# Віртуальний тренер з йоги

## Огляд
Комп'ютерна програма тренера з йоги базується на технології комп'ютерного зору, яка використовує веб-камеру для контролю користувачів через пози йоги. 
Програма використовує програмну бібліотеку Google MediaPipe Pose для виявлення суглобів скелетону людського тіла та надання реального зворотного зв'язку про точність пози.
Програма використовує властивості технології "Доповненої Реальності":
- тип "Віртуальне Дзеркало";
- людина дивиться на екран монітора як у дзеркало;
- програма розміщує на дзеркалі (додає до реального світу) віртуальні об'єкти.

## Особливості
- Виявлення пози в режимі реального часу за допомогою веб-камери
- Інтерактивне керівництво позами йоги з 4 попередньо визначеними позами
- Візуальний оверлей скелета, що показує суглоби тіла
- Аудіо зворотній зв'язок для правильних поз
- Керування жестами за допомогою рухів рук
- Накладання зображень, що показують правильні пози йоги

## Викорстання програмних бібліотек
- OpenCV (`cv2`)
- MediaPipe
- Pygame (для аудіо)
- NumPy
- Pillow (PIL)

## Архітектура

### Основні компоненти

1. **Виявлення пози MediaPipe**
   - Ініціалізує рішення MediaPipe Pose
   - Виявляє 33 суглоба скелетону тіла людини в режимі реального часу
   - Надає координати для кожного суглобу

2. **Система аудіо зворотного зв'язку**
   - Використовує мікшер Pygame для відтворення звуку
   - Відтворює "correct.wav", коли користувач правильно виконує позу
   - Включає таймер паузи, щоб запобігти безперервному звуку

3. **Візуальний інтерфейс**
   - Накладання зображень, що показують пози йоги
   - Інтерактивні кнопки для навігації
   - Перемикач відображення скелета

4. **Логіка перевірки пози**
   - Спеціальні алгоритми перевірки для кожної з 4 поз йоги
   - Основана на часі перевірка, щоб забезпечити правильне виконання пози
   - Порівняння координат для визначення точності пози

### Пози Йоги
Програма включає 4 пози йоги:
1. **Поза 1**: Статична поза з п'ятками вище протилежного коліна та лікті вище плечей
2. **Поза 2**: Поза з широко розставленими ногами з нігами ширше стегон та лікті вище плечей
3. **Поза 3**: Поза з широко розставленими ногами з руками, розташованими праворуч від п'яток
4. **Поза 4**: Перевернута поза з стегнами вище плечей

### Система керування
Програма використовує керування жестами:
- **Наступна поза**: Перехід до наступної пози йоги в послідовності
- **Попередня поза**: Перехід до попередньої пози йоги в послідовності
- **Перемикач скелета**: Показати/сховати накладання скелета
- **Вихід**: Закрити програму

Керування активується шляхом утримання пальця над областю кнопки протягом 1 секунди.

## Технічні деталі

### Алгоритми перевірки пози

#### Перевірка пози 1
```python
heel_above = (
    landmarks[mp_pose.PoseLandmark.LEFT_HEEL].y < landmarks[mp_pose.PoseLandmark.RIGHT_KNEE].y or
    landmarks[mp_pose.PoseLandmark.RIGHT_HEEL].y < landmarks[mp_pose.PoseLandmark.LEFT_KNEE].y
)
elbows_above = (
    landmarks[mp_pose.PoseLandmark.LEFT_ELBOW].y < landmarks[mp_pose.PoseLandmark.LEFT_SHOULDER].y and
    landmarks[mp_pose.PoseLandmark.RIGHT_ELBOW].y < landmarks[mp_pose.PoseLandmark.RIGHT_SHOULDER].y
)
```

#### Перевірка пози 2
```python
toes_width = abs(
    landmarks[mp_pose.PoseLandmark.LEFT_FOOT_INDEX].x -
    landmarks[mp_pose.PoseLandmark.RIGHT_FOOT_INDEX].x
) > 0.15
elbows_above = (
    landmarks[mp_pose.PoseLandmark.LEFT_ELBOW].y < landmarks[mp_pose.PoseLandmark.LEFT_SHOULDER].y and
    landmarks[mp_pose.PoseLandmark.RIGHT_ELBOW].y < landmarks[mp_pose.PoseLandmark.RIGHT_SHOULDER].y
)
```

#### Перевірка пози 3
```python
toes_width = abs(
    landmarks[mp_pose.PoseLandmark.LEFT_FOOT_INDEX].x -
    landmarks[mp_pose.PoseLandmark.RIGHT_FOOT_INDEX].x
) > 0.15
hand_foot = (
    landmarks[mp_pose.PoseLandmark.RIGHT_INDEX].x > landmarks[mp_pose.PoseLandmark.RIGHT_HEEL].x or
    landmarks[mp_pose.PoseLandmark.LEFT_INDEX].x > landmarks[mp_pose.PoseLandmark.LEFT_HEEL].x
)
```

#### Перевірка пози 4
```python
hips_y = (landmarks[mp_pose.PoseLandmark.LEFT_HIP].y + landmarks[mp_pose.PoseLandmark.RIGHT_HIP].y) / 2
shoulders_y = (landmarks[mp_pose.PoseLandmark.LEFT_SHOULDER].y + landmarks[mp_pose.PoseLandmark.RIGHT_SHOULDER].y) / 2
is_correct = hips_y < shoulders_y
```

### Взаємодія з кнопками
Кнопки реалізовані як регіони на основі координат, які реагують на положення пальців:
- Кнопки розташовані праворуч на екрані
- Активація вимагає утримання пальця над кнопкою протягом 1 секунди
- Візуальний зворотній зв'язок показує стан кнопки (натиснуто/не натиснуто)

### Аудіо зворотній зв'язок
- Правильні пози запускають аудіо зворотній зв'язок після 1 секунди стабільної пози
- Пауза звуку запобігає безперервному відтворенню (інтервал 3 секунди)
- Використовує мікшер Pygame для підтримки роботи на різних платформах


## Інструкція із налаштування 

1. Встановлення бібліотек
pip install opencv-python mediapipe pygame Pillow

## Інструкції з використання

1. Переконайтеся, що всі необхідні файли присутні:
   - `correct.wav` (аудіо зворотній зв'язок)
   - `pose1.jpg`, `pose2.jpg`, `pose3.jpg`, `pose4.jpg` (еталонні зображення поз)
   - `goodbye.jpg` (зображення екрану виходу)

2. Запустіть програму: `python yoga.py`

3. Розташуйте себе перед веб-камерою

4. Дотримуйтесь показаної еталонної пози йоги

5. Використовуйте жести руками, щоб активувати кнопки праворуч на екрані

6. Натисніть 'q', щоб вийти з програми

## Обмеження

- Вимагає хороших умов освітлення для точного виявлення пози
- Потребує достатньо простору для виконання поз йоги
- Точність залежить від кута камери та положення користувача
- Може мати труднощі з виявленням поз з прихованими частинами тіла
- Вимагає шрифтів Windows (Arial) для відображення тексту

## Потенційні покращення

1. Додати більше поз йоги з відповідними алгоритмами перевірки
2. Реалізувати рівні складності з регульованим допуском
3. Додати відстеження тривалості пози та статистики
4. Включити пропозиції з виправлення пози
5. Підтримка для власних зображень поз
6. Багатомовна підтримка інтерфейсу
7. Функція калібрування для різних пропорцій тіла
8. Оптимізація продуктивності для обладнання нижчого класу